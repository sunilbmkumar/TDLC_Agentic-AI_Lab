"use strict";exports.id=339,exports.ids=[339],exports.modules={41339:(St,ge,R)=>{R.d(ge,{fromHttp:()=>Tt});function ye(e,t,r){return e.$source||(e.$source={}),e.$source[t]=r,e}var G;(function(e){e.HEADER="header",e.QUERY="query"})(G||(G={}));var Q;(function(e){e.HEADER="header",e.QUERY="query"})(Q||(Q={}));var X;(function(e){e.HTTP="http",e.HTTPS="https"})(X||(X={}));var U;(function(e){e.MD5="md5",e.CRC32="crc32",e.CRC32C="crc32c",e.SHA1="sha1",e.SHA256="sha256"})(U||(U={}));const bt=e=>{const t=[];return e.sha256!==void 0&&t.push({algorithmId:()=>U.SHA256,checksumConstructor:()=>e.sha256}),e.md5!=null&&t.push({algorithmId:()=>U.MD5,checksumConstructor:()=>e.md5}),{_checksumAlgorithms:t,addChecksumAlgorithm(r){this._checksumAlgorithms.push(r)},checksumAlgorithms(){return this._checksumAlgorithms}}},At=e=>{const t={};return e.checksumAlgorithms().forEach(r=>{t[r.algorithmId()]=r.checksumConstructor()}),t},_t=e=>({...getChecksumConfiguration(e)}),Rt=e=>({...resolveChecksumRuntimeConfig(e)});var ee;(function(e){e[e.HEADER=0]="HEADER",e[e.TRAILER=1]="TRAILER"})(ee||(ee={}));var te;(function(e){e.PROFILE="profile",e.SSO_SESSION="sso-session",e.SERVICES="services"})(te||(te={}));var re;(function(e){e.HTTP_0_9="http/0.9",e.HTTP_1_0="http/1.0",e.TDS_8_0="tds/8.0"})(re||(re={}));class It{constructor({name:t,kind:r=FieldPosition.HEADER,values:n=[]}){this.name=t,this.kind=r,this.values=n}add(t){this.values.push(t)}set(t){this.values=t}remove(t){this.values=this.values.filter(r=>r!==t)}toString(){return this.values.map(t=>t.includes(",")||t.includes(" ")?`"${t}"`:t).join(", ")}get(){return this.values}}class F{constructor(t){this.method=t.method||"GET",this.hostname=t.hostname||"localhost",this.port=t.port,this.query=t.query||{},this.headers=t.headers||{},this.body=t.body,this.protocol=t.protocol?t.protocol.slice(-1)!==":"?`${t.protocol}:`:t.protocol:"https:",this.path=t.path?t.path.charAt(0)!=="/"?`/${t.path}`:t.path:"/",this.username=t.username,this.password=t.password,this.fragment=t.fragment}static clone(t){const r=new F({...t,headers:{...t.headers}});return r.query&&(r.query=we(r.query)),r}static isInstance(t){if(!t)return!1;const r=t;return"method"in r&&"protocol"in r&&"hostname"in r&&"path"in r&&typeof r.query=="object"&&typeof r.headers=="object"}clone(){return F.clone(this)}}function we(e){return Object.keys(e).reduce((t,r)=>{const n=e[r];return{...t,[r]:Array.isArray(n)?[...n]:n}},{})}class Ee{constructor(t){this.statusCode=t.statusCode,this.reason=t.reason,this.headers=t.headers||{},this.body=t.body}static isInstance(t){if(!t)return!1;const r=t;return typeof r.statusCode=="number"&&typeof r.headers=="object"}}var Te=R(42445),j=R(58611),K=R(65692);const Ce=["ECONNRESET","EPIPE","ETIMEDOUT"],Se=e=>{const t={};for(const r of Object.keys(e)){const n=e[r];t[r]=Array.isArray(n)?n.join(","):n}return t},S={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e)},ne=1e3,be=(e,t,r=0)=>{if(!r)return-1;const n=s=>{const o=S.setTimeout(()=>{e.destroy(),t(Object.assign(new Error(`Socket timed out without establishing a connection within ${r} ms`),{name:"TimeoutError"}))},r-s),i=a=>{a?.connecting?a.on("connect",()=>{S.clearTimeout(o)}):S.clearTimeout(o)};e.socket?i(e.socket):e.on("socket",i)};return r<2e3?(n(0),0):S.setTimeout(n.bind(null,ne),ne)},Ae=3e3,_e=(e,{keepAlive:t,keepAliveMsecs:r},n=Ae)=>{if(t!==!0)return-1;const s=()=>{e.socket?e.socket.setKeepAlive(t,r||0):e.on("socket",o=>{o.setKeepAlive(t,r||0)})};return n===0?(s(),0):S.setTimeout(s,n)},se=3e3,Re=(e,t,r=xe)=>{const n=s=>{const o=r-s,i=()=>{e.destroy(),t(Object.assign(new Error(`Connection timed out after ${r} ms`),{name:"TimeoutError"}))};e.socket?(e.socket.setTimeout(o,i),e.on("close",()=>e.socket?.removeListener("timeout",i))):e.setTimeout(o,i)};return 0<r&&r<6e3?(n(0),0):S.setTimeout(n.bind(null,r===0?0:se),se)};var oe=R(2203);const ie=6e3;async function Ie(e,t,r=ie){const n=t.headers??{},s=n.Expect||n.expect;let o=-1,i=!0;s==="100-continue"&&(i=await Promise.race([new Promise(a=>{o=Number(S.setTimeout(()=>a(!0),Math.max(ie,r)))}),new Promise(a=>{e.on("continue",()=>{S.clearTimeout(o),a(!0)}),e.on("response",()=>{S.clearTimeout(o),a(!1)}),e.on("error",()=>{S.clearTimeout(o),a(!1)})})])),i&&Ne(e,t.body)}function Ne(e,t){if(t instanceof oe.Readable){t.pipe(e);return}if(t){if(Buffer.isBuffer(t)||typeof t=="string"){e.end(t);return}const r=t;if(typeof r=="object"&&r.buffer&&typeof r.byteOffset=="number"&&typeof r.byteLength=="number"){e.end(Buffer.from(r.buffer,r.byteOffset,r.byteLength));return}e.end(Buffer.from(t));return}e.end()}const xe=0;class v{static create(t){return typeof t?.handle=="function"?t:new v(t)}static checkSocketUsage(t,r,n=console){const{sockets:s,requests:o,maxSockets:i}=t;if(typeof i!="number"||i===1/0)return r;const a=15e3;if(Date.now()-a<r)return r;if(s&&o)for(const d in s){const g=s[d]?.length??0,w=o[d]?.length??0;if(g>=i&&w>=2*i)return n?.warn?.(`@smithy/node-http-handler:WARN - socket usage at capacity=${g} and ${w} additional requests are enqueued.
See https://docs.aws.amazon.com/sdk-for-javascript/v3/developer-guide/node-configuring-maxsockets.html
or increase socketAcquisitionWarningTimeout=(millis) in the NodeHttpHandler config.`),Date.now()}return r}constructor(t){this.socketWarningTimestamp=0,this.metadata={handlerProtocol:"http/1.1"},this.configProvider=new Promise((r,n)=>{typeof t=="function"?t().then(s=>{r(this.resolveDefaultConfig(s))}).catch(n):r(this.resolveDefaultConfig(t))})}resolveDefaultConfig(t){const{requestTimeout:r,connectionTimeout:n,socketTimeout:s,socketAcquisitionWarningTimeout:o,httpAgent:i,httpsAgent:a}=t||{},d=!0,g=50;return{connectionTimeout:n,requestTimeout:r??s,socketAcquisitionWarningTimeout:o,httpAgent:(()=>i instanceof j.Agent||typeof i?.destroy=="function"?i:new j.Agent({keepAlive:d,maxSockets:g,...i}))(),httpsAgent:(()=>a instanceof K.Agent||typeof a?.destroy=="function"?a:new K.Agent({keepAlive:d,maxSockets:g,...a}))(),logger:console}}destroy(){this.config?.httpAgent?.destroy(),this.config?.httpsAgent?.destroy()}async handle(t,{abortSignal:r}={}){return this.config||(this.config=await this.configProvider),new Promise((n,s)=>{let o;const i=[],a=async l=>{await o,i.forEach(S.clearTimeout),n(l)},d=async l=>{await o,i.forEach(S.clearTimeout),s(l)};if(!this.config)throw new Error("Node HTTP request handler config is not resolved");if(r?.aborted){const l=new Error("Request aborted");l.name="AbortError",d(l);return}const g=t.protocol==="https:",w=g?this.config.httpsAgent:this.config.httpAgent;i.push(S.setTimeout(()=>{this.socketWarningTimestamp=v.checkSocketUsage(w,this.socketWarningTimestamp,this.config.logger)},this.config.socketAcquisitionWarningTimeout??(this.config.requestTimeout??2e3)+(this.config.connectionTimeout??1e3)));const c=(0,Te.G)(t.query||{});let u;if(t.username!=null||t.password!=null){const l=t.username??"",y=t.password??"";u=`${l}:${y}`}let h=t.path;c&&(h+=`?${c}`),t.fragment&&(h+=`#${t.fragment}`);let p=t.hostname??"";p[0]==="["&&p.endsWith("]")?p=t.hostname.slice(1,-1):p=t.hostname;const T={headers:t.headers,host:p,method:t.method,path:h,port:t.port,agent:w,auth:u},m=(g?K.request:j.request)(T,l=>{const y=new Ee({statusCode:l.statusCode||-1,reason:l.statusMessage,headers:Se(l.headers),body:l});a({response:y})});if(m.on("error",l=>{Ce.includes(l.code)?d(Object.assign(l,{name:"TimeoutError"})):d(l)}),r){const l=()=>{m.destroy();const y=new Error("Request aborted");y.name="AbortError",d(y)};if(typeof r.addEventListener=="function"){const y=r;y.addEventListener("abort",l,{once:!0}),m.once("close",()=>y.removeEventListener("abort",l))}else r.onabort=l}i.push(be(m,d,this.config.connectionTimeout)),i.push(Re(m,d,this.config.requestTimeout));const E=T.agent;typeof E=="object"&&"keepAlive"in E&&i.push(_e(m,{keepAlive:E.keepAlive,keepAliveMsecs:E.keepAliveMsecs})),o=Ie(m,t,this.config.requestTimeout).catch(l=>(i.forEach(S.clearTimeout),s(l)))})}updateHttpClientConfig(t,r){this.config=void 0,this.configProvider=this.configProvider.then(n=>({...n,[t]:r}))}httpHandlerConfigs(){return this.config??{}}}var Nt=R(85675);class xt{constructor(t){this.sessions=[],this.sessions=t??[]}poll(){if(this.sessions.length>0)return this.sessions.shift()}offerLast(t){this.sessions.push(t)}contains(t){return this.sessions.includes(t)}remove(t){this.sessions=this.sessions.filter(r=>r!==t)}[Symbol.iterator](){return this.sessions[Symbol.iterator]()}destroy(t){for(const r of this.sessions)r===t&&(r.destroyed||r.destroy())}}class $t{constructor(t){if(this.sessionCache=new Map,this.config=t,this.config.maxConcurrency&&this.config.maxConcurrency<=0)throw new RangeError("maxConcurrency must be greater than zero.")}lease(t,r){const n=this.getUrlString(t),s=this.sessionCache.get(n);if(s){const d=s.poll();if(d&&!this.config.disableConcurrency)return d}const o=http2.connect(n);this.config.maxConcurrency&&o.settings({maxConcurrentStreams:this.config.maxConcurrency},d=>{if(d)throw new Error("Fail to set maxConcurrentStreams to "+this.config.maxConcurrency+"when creating new session for "+t.destination.toString())}),o.unref();const i=()=>{o.destroy(),this.deleteSession(n,o)};o.on("goaway",i),o.on("error",i),o.on("frameError",i),o.on("close",()=>this.deleteSession(n,o)),r.requestTimeout&&o.setTimeout(r.requestTimeout,i);const a=this.sessionCache.get(n)||new NodeHttp2ConnectionPool;return a.offerLast(o),this.sessionCache.set(n,a),o}deleteSession(t,r){const n=this.sessionCache.get(t);!n||!n.contains(r)||(n.remove(r),this.sessionCache.set(t,n))}release(t,r){const n=this.getUrlString(t);this.sessionCache.get(n)?.offerLast(r)}destroy(){for(const[t,r]of this.sessionCache){for(const n of r)n.destroyed||n.destroy(),r.remove(n);this.sessionCache.delete(t)}}setMaxConcurrentStreams(t){if(t&&t<=0)throw new RangeError("maxConcurrentStreams must be greater than zero.");this.config.maxConcurrency=t}setDisableConcurrentStreams(t){this.config.disableConcurrency=t}getUrlString(t){return t.destination.toString()}}class ae{static create(t){return typeof t?.handle=="function"?t:new ae(t)}constructor(t){this.metadata={handlerProtocol:"h2"},this.connectionManager=new NodeHttp2ConnectionManager({}),this.configProvider=new Promise((r,n)=>{typeof t=="function"?t().then(s=>{r(s||{})}).catch(n):r(t||{})})}destroy(){this.connectionManager.destroy()}async handle(t,{abortSignal:r}={}){this.config||(this.config=await this.configProvider,this.connectionManager.setDisableConcurrentStreams(this.config.disableConcurrentStreams||!1),this.config.maxConcurrentStreams&&this.connectionManager.setMaxConcurrentStreams(this.config.maxConcurrentStreams));const{requestTimeout:n,disableConcurrentStreams:s}=this.config;return new Promise((o,i)=>{let a=!1,d;const g=async C=>{await d,o(C)},w=async C=>{await d,i(C)};if(r?.aborted){a=!0;const C=new Error("Request aborted");C.name="AbortError",w(C);return}const{hostname:c,method:u,port:h,protocol:p,query:T}=t;let f="";if(t.username!=null||t.password!=null){const C=t.username??"",A=t.password??"";f=`${C}:${A}@`}const m=`${p}//${f}${c}${h?`:${h}`:""}`,E={destination:new URL(m)},l=this.connectionManager.lease(E,{requestTimeout:this.config?.sessionTimeout,disableConcurrentStreams:s||!1}),y=C=>{s&&this.destroySession(l),a=!0,w(C)},x=buildQueryString(T||{});let k=t.path;x&&(k+=`?${x}`),t.fragment&&(k+=`#${t.fragment}`);const b=l.request({...t.headers,[constants.HTTP2_HEADER_PATH]:k,[constants.HTTP2_HEADER_METHOD]:u});if(l.ref(),b.on("response",C=>{const A=new HttpResponse({statusCode:C[":status"]||-1,headers:getTransformedHeaders(C),body:b});a=!0,g({response:A}),s&&(l.close(),this.connectionManager.deleteSession(m,l))}),n&&b.setTimeout(n,()=>{b.close();const C=new Error(`Stream timed out because of no activity for ${n} ms`);C.name="TimeoutError",y(C)}),r){const C=()=>{b.close();const A=new Error("Request aborted");A.name="AbortError",y(A)};if(typeof r.addEventListener=="function"){const A=r;A.addEventListener("abort",C,{once:!0}),b.once("close",()=>A.removeEventListener("abort",C))}else r.onabort=C}b.on("frameError",(C,A,Ct)=>{y(new Error(`Frame type id ${C} in stream id ${Ct} has failed with code ${A}.`))}),b.on("error",y),b.on("aborted",()=>{y(new Error(`HTTP/2 stream is abnormally aborted in mid-communication with result code ${b.rstCode}.`))}),b.on("close",()=>{l.unref(),s&&l.destroy(),a||y(new Error("Unexpected error: http2 request did not get a response"))}),d=writeRequestBody(b,t,n)})}updateHttpClientConfig(t,r){this.config=void 0,this.configProvider=this.configProvider.then(n=>({...n,[t]:r}))}httpHandlerConfigs(){return this.config??{}}destroySession(t){t.destroyed||t.destroy()}}class kt extends oe.Writable{constructor(){super(...arguments),this.bufferedBytes=[]}_write(t,r,n){this.bufferedBytes.push(t),n()}}const Ot=e=>$e(e)?ke(e):new Promise((t,r)=>{const n=new Collector;e.pipe(n),e.on("error",s=>{n.end(),r(s)}),n.on("error",r),n.on("finish",function(){const s=new Uint8Array(Buffer.concat(this.bufferedBytes));t(s)})}),$e=e=>typeof ReadableStream=="function"&&e instanceof ReadableStream;async function ke(e){const t=[],r=e.getReader();let n=!1,s=0;for(;!n;){const{done:a,value:d}=await r.read();d&&(t.push(d),s+=d.length),n=a}const o=new Uint8Array(s);let i=0;for(const a of t)o.set(a,i),i+=a.length;return o}class H extends Error{constructor(t,r=!0){let n,s=!0;typeof r=="boolean"?(n=void 0,s=r):r!=null&&typeof r=="object"&&(n=r.logger,s=r.tryNextLink??!0),super(t),this.name="ProviderError",this.tryNextLink=s,Object.setPrototypeOf(this,H.prototype),n?.debug?.(`@smithy/property-provider ${s?"->":"(!)"} ${t}`)}static from(t,r=!0){return Object.assign(new this(t.message,r),t)}}class I extends H{constructor(t,r=!0){super(t,r),this.name="CredentialsProviderError",Object.setPrototypeOf(this,I.prototype)}}class ce extends H{constructor(t,r=!0){super(t,r),this.name="TokenProviderError",Object.setPrototypeOf(this,ce.prototype)}}const Mt=(...e)=>async()=>{if(e.length===0)throw new ProviderError("No providers in chain");let t;for(const r of e)try{return await r()}catch(n){if(t=n,n?.tryNextLink)continue;throw n}throw t};var Oe=R(91943),Me=R.n(Oe);const Pt="127.0.0.0/8",Dt="::1/128",Pe="169.254.170.2",De="169.254.170.23",Le="[fd00:ec2::23]",Ue=(e,t)=>{if(e.protocol!=="https:"&&!(e.hostname===Pe||e.hostname===De||e.hostname===Le)){if(e.hostname.includes("[")){if(e.hostname==="[::1]"||e.hostname==="[0000:0000:0000:0000:0000:0000:0000:0001]")return}else{if(e.hostname==="localhost")return;const r=e.hostname.split("."),n=s=>{const o=parseInt(s,10);return 0<=o&&o<=255};if(r[0]==="127"&&n(r[1])&&n(r[2])&&n(r[3])&&r.length===4)return}throw new I(`URL not accepted. It must either be HTTPS or match one of the following:
  - loopback CIDR 127.0.0.0/8 or [::1/128]
  - ECS container host 169.254.170.2
  - EKS container host 169.254.170.23 or [fd00:ec2::23]`,{logger:t})}},$=(e,t)=>{const r=[];if(e&&r.push(e),t)for(const n of t)r.push(n);return r},N=(e,t)=>`${e||"anonymous"}${t&&t.length>0?` (a.k.a. ${t.join(",")})`:""}`,de=()=>{let e=[],t=[],r=!1;const n=new Set,s=c=>c.sort((u,h)=>ue[h.step]-ue[u.step]||he[h.priority||"normal"]-he[u.priority||"normal"]),o=c=>{let u=!1;const h=p=>{const T=$(p.name,p.aliases);if(T.includes(c)){u=!0;for(const f of T)n.delete(f);return!1}return!0};return e=e.filter(h),t=t.filter(h),u},i=c=>{let u=!1;const h=p=>{if(p.middleware===c){u=!0;for(const T of $(p.name,p.aliases))n.delete(T);return!1}return!0};return e=e.filter(h),t=t.filter(h),u},a=c=>(e.forEach(u=>{c.add(u.middleware,{...u})}),t.forEach(u=>{c.addRelativeTo(u.middleware,{...u})}),c.identifyOnResolve?.(w.identifyOnResolve()),c),d=c=>{const u=[];return c.before.forEach(h=>{h.before.length===0&&h.after.length===0?u.push(h):u.push(...d(h))}),u.push(c),c.after.reverse().forEach(h=>{h.before.length===0&&h.after.length===0?u.push(h):u.push(...d(h))}),u},g=(c=!1)=>{const u=[],h=[],p={};return e.forEach(f=>{const m={...f,before:[],after:[]};for(const E of $(m.name,m.aliases))p[E]=m;u.push(m)}),t.forEach(f=>{const m={...f,before:[],after:[]};for(const E of $(m.name,m.aliases))p[E]=m;h.push(m)}),h.forEach(f=>{if(f.toMiddleware){const m=p[f.toMiddleware];if(m===void 0){if(c)return;throw new Error(`${f.toMiddleware} is not found when adding ${N(f.name,f.aliases)} middleware ${f.relation} ${f.toMiddleware}`)}f.relation==="after"&&m.after.push(f),f.relation==="before"&&m.before.push(f)}}),s(u).map(d).reduce((f,m)=>(f.push(...m),f),[])},w={add:(c,u={})=>{const{name:h,override:p,aliases:T}=u,f={step:"initialize",priority:"normal",middleware:c,...u},m=$(h,T);if(m.length>0){if(m.some(E=>n.has(E))){if(!p)throw new Error(`Duplicate middleware name '${N(h,T)}'`);for(const E of m){const l=e.findIndex(x=>x.name===E||x.aliases?.some(k=>k===E));if(l===-1)continue;const y=e[l];if(y.step!==f.step||f.priority!==y.priority)throw new Error(`"${N(y.name,y.aliases)}" middleware with ${y.priority} priority in ${y.step} step cannot be overridden by "${N(h,T)}" middleware with ${f.priority} priority in ${f.step} step.`);e.splice(l,1)}}for(const E of m)n.add(E)}e.push(f)},addRelativeTo:(c,u)=>{const{name:h,override:p,aliases:T}=u,f={middleware:c,...u},m=$(h,T);if(m.length>0){if(m.some(E=>n.has(E))){if(!p)throw new Error(`Duplicate middleware name '${N(h,T)}'`);for(const E of m){const l=t.findIndex(x=>x.name===E||x.aliases?.some(k=>k===E));if(l===-1)continue;const y=t[l];if(y.toMiddleware!==f.toMiddleware||y.relation!==f.relation)throw new Error(`"${N(y.name,y.aliases)}" middleware ${y.relation} "${y.toMiddleware}" middleware cannot be overridden by "${N(h,T)}" middleware ${f.relation} "${f.toMiddleware}" middleware.`);t.splice(l,1)}}for(const E of m)n.add(E)}t.push(f)},clone:()=>a(de()),use:c=>{c.applyToStack(w)},remove:c=>typeof c=="string"?o(c):i(c),removeByTag:c=>{let u=!1;const h=p=>{const{tags:T,name:f,aliases:m}=p;if(T&&T.includes(c)){const E=$(f,m);for(const l of E)n.delete(l);return u=!0,!1}return!0};return e=e.filter(h),t=t.filter(h),u},concat:c=>{const u=a(de());return u.use(c),u.identifyOnResolve(r||u.identifyOnResolve()||(c.identifyOnResolve?.()??!1)),u},applyToStack:a,identify:()=>g(!0).map(c=>{const u=c.step??c.relation+" "+c.toMiddleware;return N(c.name,c.aliases)+" - "+u}),identifyOnResolve(c){return typeof c=="boolean"&&(r=c),r},resolve:(c,u)=>{for(const h of g().map(p=>p.middleware).reverse())c=h(c,u);return r&&console.log(w.identify()),c}};return w},ue={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},he={high:3,normal:2,low:1};class Lt{constructor(t){this.config=t,this.middlewareStack=constructStack()}send(t,r,n){const s=typeof r!="function"?r:void 0,o=typeof r=="function"?r:n,i=s===void 0&&this.config.cacheMiddleware===!0;let a;if(i){this.handlers||(this.handlers=new WeakMap);const d=this.handlers;d.has(t.constructor)?a=d.get(t.constructor):(a=t.resolveMiddleware(this.middlewareStack,this.config,s),d.set(t.constructor,a))}else delete this.handlers,a=t.resolveMiddleware(this.middlewareStack,this.config,s);if(o)a(t).then(d=>o(null,d.output),d=>o(d)).catch(()=>{});else return a(t).then(d=>d.output)}destroy(){this.config?.requestHandler?.destroy?.(),delete this.handlers}}var Fe=R(4902);const Ut=async(e=new Uint8Array,t)=>{if(e instanceof Uint8Array)return Uint8ArrayBlobAdapter.mutate(e);if(!e)return Uint8ArrayBlobAdapter.mutate(new Uint8Array);const r=t.streamCollector(e);return Uint8ArrayBlobAdapter.mutate(await r)};function Ft(e,t){return new ve(e,t)}class ve{constructor(t,r){this.input=t,this.context=r,this.query={},this.method="",this.headers={},this.path="",this.body=null,this.hostname="",this.resolvePathStack=[]}async build(){const{hostname:t,protocol:r="https",port:n,path:s}=await this.context.endpoint();this.path=s;for(const o of this.resolvePathStack)o(this.path);return new HttpRequest({protocol:r,hostname:this.hostname||t,port:n,method:this.method,path:this.path,query:this.query,body:this.body,headers:this.headers})}hn(t){return this.hostname=t,this}bp(t){return this.resolvePathStack.push(r=>{this.path=`${r?.endsWith("/")?r.slice(0,-1):r||""}`+t}),this}p(t,r,n,s){return this.resolvePathStack.push(o=>{this.path=resolvedPath(o,this.input,t,r,n,s)}),this}h(t){return this.headers=t,this}q(t){return this.query=t,this}b(t){return this.body=t,this}m(t){return this.method=t,this}}class He{constructor(){this.middlewareStack=constructStack()}static classBuilder(){return new ze}resolveMiddlewareWithContext(t,r,n,{middlewareFn:s,clientName:o,commandName:i,inputFilterSensitiveLog:a,outputFilterSensitiveLog:d,smithyContext:g,additionalContext:w,CommandCtor:c}){for(const f of s.bind(this)(c,t,r,n))this.middlewareStack.use(f);const u=t.concat(this.middlewareStack),{logger:h}=r,p={logger:h,clientName:o,commandName:i,inputFilterSensitiveLog:a,outputFilterSensitiveLog:d,[SMITHY_CONTEXT_KEY]:{commandInstance:this,...g},...w},{requestHandler:T}=r;return u.resolve(f=>T.handle(f.request,n||{}),p)}}class ze{constructor(){this._init=()=>{},this._ep={},this._middlewareFn=()=>[],this._commandName="",this._clientName="",this._additionalContext={},this._smithyContext={},this._inputFilterSensitiveLog=t=>t,this._outputFilterSensitiveLog=t=>t,this._serializer=null,this._deserializer=null}init(t){this._init=t}ep(t){return this._ep=t,this}m(t){return this._middlewareFn=t,this}s(t,r,n={}){return this._smithyContext={service:t,operation:r,...n},this}c(t={}){return this._additionalContext=t,this}n(t,r){return this._clientName=t,this._commandName=r,this}f(t=n=>n,r=n=>n){return this._inputFilterSensitiveLog=t,this._outputFilterSensitiveLog=r,this}ser(t){return this._serializer=t,this}de(t){return this._deserializer=t,this}build(){const t=this;let r;return r=class extends He{static getEndpointParameterInstructions(){return t._ep}constructor(...[n]){super(),this.serialize=t._serializer,this.deserialize=t._deserializer,this.input=n??{},t._init(this)}resolveMiddleware(n,s,o){return this.resolveMiddlewareWithContext(n,s,o,{CommandCtor:r,middlewareFn:t._middlewareFn,clientName:t._clientName,commandName:t._commandName,inputFilterSensitiveLog:t._inputFilterSensitiveLog,outputFilterSensitiveLog:t._outputFilterSensitiveLog,smithyContext:t._smithyContext,additionalContext:t._additionalContext})}}}}const vt=e=>{switch(e){case"true":return!0;case"false":return!1;default:throw new Error(`Unable to parse boolean value "${e}"`)}},Ht=e=>{if(e!=null){if(typeof e=="number"){if((e===0||e===1)&&B.warn(W(`Expected boolean, got ${typeof e}: ${e}`)),e===0)return!1;if(e===1)return!0}if(typeof e=="string"){const t=e.toLowerCase();if((t==="false"||t==="true")&&B.warn(W(`Expected boolean, got ${typeof e}: ${e}`)),t==="false")return!1;if(t==="true")return!0}if(typeof e=="boolean")return e;throw new TypeError(`Expected boolean, got ${typeof e}: ${e}`)}},z=e=>{if(e!=null){if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return String(t)!==String(e)&&B.warn(W(`Expected number but observed string: ${e}`)),t}if(typeof e=="number")return e;throw new TypeError(`Expected number, got ${typeof e}: ${e}`)}},We=Math.ceil(2**127*(2-2**-23)),J=e=>{const t=z(e);if(t!==void 0&&!Number.isNaN(t)&&t!==1/0&&t!==-1/0&&Math.abs(t)>We)throw new TypeError(`Expected 32-bit float, got ${e}`);return t},q=e=>{if(e!=null){if(Number.isInteger(e)&&!Number.isNaN(e))return e;throw new TypeError(`Expected integer, got ${typeof e}: ${e}`)}},zt=null,fe=e=>Y(e,32),le=e=>Y(e,16),me=e=>Y(e,8),Y=(e,t)=>{const r=q(e);if(r!==void 0&&Be(r,t)!==r)throw new TypeError(`Expected ${t}-bit integer, got ${e}`);return r},Be=(e,t)=>{switch(t){case 32:return Int32Array.of(e)[0];case 16:return Int16Array.of(e)[0];case 8:return Int8Array.of(e)[0]}},Wt=(e,t)=>{if(e==null)throw t?new TypeError(`Expected a non-null value for ${t}`):new TypeError("Expected a non-null value");return e},je=e=>{if(e==null)return;if(typeof e=="object"&&!Array.isArray(e))return e;const t=Array.isArray(e)?"array":typeof e;throw new TypeError(`Expected object, got ${t}: ${e}`)},Bt=e=>{if(e!=null){if(typeof e=="string")return e;if(["boolean","number","bigint"].includes(typeof e))return B.warn(W(`Expected string, got ${typeof e}: ${e}`)),String(e);throw new TypeError(`Expected string, got ${typeof e}: ${e}`)}},jt=e=>{if(e==null)return;const t=je(e),r=Object.entries(t).filter(([,n])=>n!=null).map(([n])=>n);if(r.length===0)throw new TypeError("Unions must have exactly one non-null member. None were found.");if(r.length>1)throw new TypeError(`Unions must have exactly one non-null member. Keys ${r} were not null.`);return t},Kt=e=>z(typeof e=="string"?O(e):e),Jt=null,Ke=e=>J(typeof e=="string"?O(e):e),Je=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,O=e=>{const t=e.match(Je);if(t===null||t[0].length!==e.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(e)},qt=e=>typeof e=="string"?pe(e):z(e),Yt=null,Vt=null,Zt=e=>typeof e=="string"?pe(e):J(e),pe=e=>{switch(e){case"NaN":return NaN;case"Infinity":return 1/0;case"-Infinity":return-1/0;default:throw new Error(`Unable to parse float value: ${e}`)}},Gt=e=>q(typeof e=="string"?O(e):e),Qt=null,Xt=e=>fe(typeof e=="string"?O(e):e),qe=e=>le(typeof e=="string"?O(e):e),Ye=e=>me(typeof e=="string"?O(e):e),W=e=>String(new TypeError(e).stack||e).split(`
`).slice(0,5).filter(t=>!t.includes("stackTraceWarning")).join(`
`),B={warn:console.warn},Ve=null,V=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function er(e){const t=e.getUTCFullYear(),r=e.getUTCMonth(),n=e.getUTCDay(),s=e.getUTCDate(),o=e.getUTCHours(),i=e.getUTCMinutes(),a=e.getUTCSeconds(),d=s<10?`0${s}`:`${s}`,g=o<10?`0${o}`:`${o}`,w=i<10?`0${i}`:`${i}`,c=a<10?`0${a}`:`${a}`;return`${Ve[n]}, ${d} ${V[r]} ${t} ${g}:${w}:${c} GMT`}const Ze=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?[zZ]$/),Ge=e=>{if(e==null)return;if(typeof e!="string")throw new TypeError("RFC-3339 date-times must be expressed as strings");const t=Ze.exec(e);if(!t)throw new TypeError("Invalid RFC-3339 date-time value");const[r,n,s,o,i,a,d,g]=t,w=qe(M(n)),c=_(s,"month",1,12),u=_(o,"day",1,31);return D(w,c,u,{hours:i,minutes:a,seconds:d,fractionalMilliseconds:g})},Qe=null,tr=e=>{if(e==null)return;if(typeof e!="string")throw new TypeError("RFC-3339 date-times must be expressed as strings");const t=Qe.exec(e);if(!t)throw new TypeError("Invalid RFC-3339 date-time value");const[r,n,s,o,i,a,d,g,w]=t,c=strictParseShort(M(n)),u=_(s,"month",1,12),h=_(o,"day",1,31),p=D(c,u,h,{hours:i,minutes:a,seconds:d,fractionalMilliseconds:g});return w.toUpperCase()!="Z"&&p.setTime(p.getTime()-dt(w)),p},Xe=null,et=null,tt=null,rr=e=>{if(e==null)return;if(typeof e!="string")throw new TypeError("RFC-7231 date-times must be expressed as strings");let t=Xe.exec(e);if(t){const[r,n,s,o,i,a,d,g]=t;return D(strictParseShort(M(o)),Z(s),_(n,"day",1,31),{hours:i,minutes:a,seconds:d,fractionalMilliseconds:g})}if(t=et.exec(e),t){const[r,n,s,o,i,a,d,g]=t;return st(D(rt(o),Z(s),_(n,"day",1,31),{hours:i,minutes:a,seconds:d,fractionalMilliseconds:g}))}if(t=tt.exec(e),t){const[r,n,s,o,i,a,d,g]=t;return D(strictParseShort(M(g)),Z(n),_(s.trimLeft(),"day",1,31),{hours:o,minutes:i,seconds:a,fractionalMilliseconds:d})}throw new TypeError("Invalid RFC-7231 date-time value")},nr=e=>{if(e==null)return;let t;if(typeof e=="number")t=e;else if(typeof e=="string")t=strictParseDouble(e);else if(typeof e=="object"&&e.tag===1)t=e.value;else throw new TypeError("Epoch timestamps must be expressed as floating point numbers or their string representation");if(Number.isNaN(t)||t===1/0||t===-1/0)throw new TypeError("Epoch timestamps must be valid, non-Infinite, non-NaN numerics");return new Date(Math.round(t*1e3))},D=(e,t,r,n)=>{const s=t-1;return it(e,s,r),new Date(Date.UTC(e,s,r,_(n.hours,"hour",0,23),_(n.minutes,"minute",0,59),_(n.seconds,"seconds",0,60),ct(n.fractionalMilliseconds)))},rt=e=>{const t=new Date().getUTCFullYear(),r=Math.floor(t/100)*100+strictParseShort(M(e));return r<t?r+100:r},nt=null,st=e=>e.getTime()-new Date().getTime()>nt?new Date(Date.UTC(e.getUTCFullYear()-100,e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())):e,Z=e=>{const t=V.indexOf(e);if(t<0)throw new TypeError(`Invalid month: ${e}`);return t+1},ot=[31,28,31,30,31,30,31,31,30,31,30,31],it=(e,t,r)=>{let n=ot[t];if(t===1&&at(e)&&(n=29),r>n)throw new TypeError(`Invalid day for ${V[t]} in ${e}: ${r}`)},at=e=>e%4===0&&(e%100!==0||e%400===0),_=(e,t,r,n)=>{const s=Ye(M(e));if(s<r||s>n)throw new TypeError(`${t} must be between ${r} and ${n}, inclusive`);return s},ct=e=>e==null?0:Ke("0."+e)*1e3,dt=e=>{const t=e[0];let r=1;if(t=="+")r=1;else if(t=="-")r=-1;else throw new TypeError(`Offset direction, ${t}, must be "+" or "-"`);const n=Number(e.substring(1,3)),s=Number(e.substring(4,6));return r*(n*60+s)*60*1e3},M=e=>{let t=0;for(;t<e.length-1&&e.charAt(t)==="0";)t++;return t===0?e:e.slice(t)};class L extends Error{constructor(t){super(t.message),Object.setPrototypeOf(this,Object.getPrototypeOf(this).constructor.prototype),this.name=t.name,this.$fault=t.$fault,this.$metadata=t.$metadata}static isInstance(t){if(!t)return!1;const r=t;return L.prototype.isPrototypeOf(r)||Boolean(r.$fault)&&Boolean(r.$metadata)&&(r.$fault==="client"||r.$fault==="server")}static[Symbol.hasInstance](t){if(!t)return!1;const r=t;return this===L?L.isInstance(t):L.isInstance(t)?r.name&&this.name?this.prototype.isPrototypeOf(t)||r.name===this.name:this.prototype.isPrototypeOf(t):!1}}const sr=(e,t={})=>{Object.entries(t).filter(([,n])=>n!==void 0).forEach(([n,s])=>{(e[n]==null||e[n]==="")&&(e[n]=s)});const r=e.message||e.Message||"UnknownError";return e.message=r,delete e.Message,e},ut=({output:e,parsedBody:t,exceptionCtor:r,errorCode:n})=>{const s=ht(e),o=s.httpStatusCode?s.httpStatusCode+"":void 0,i=new r({name:t?.code||t?.Code||n||o||"UnknownError",$fault:"client",$metadata:s});throw decorateServiceException(i,t)},or=e=>({output:t,parsedBody:r,errorCode:n})=>{ut({output:t,parsedBody:r,exceptionCtor:e,errorCode:n})},ht=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}),ir=e=>{const t=[];for(const r in AlgorithmId){const n=AlgorithmId[r];e[n]!==void 0&&t.push({algorithmId:()=>n,checksumConstructor:()=>e[n]})}return{_checksumAlgorithms:t,addChecksumAlgorithm(r){this._checksumAlgorithms.push(r)},checksumAlgorithms(){return this._checksumAlgorithms}}},ar=e=>{const t={};return e.checksumAlgorithms().forEach(r=>{t[r.algorithmId()]=r.checksumConstructor()}),t},cr=e=>({...getChecksumConfiguration(e),...getRetryConfiguration(e)}),dr=null,ur=e=>({...resolveChecksumRuntimeConfig(e),...resolveRetryRuntimeConfig(e)}),P=function(t){return Object.assign(new String(t),{deserializeJSON(){return JSON.parse(String(t))},toString(){return String(t)},toJSON(){return String(t)}})};P.from=e=>e&&typeof e=="object"&&(e instanceof P||"deserializeJSON"in e)?e:typeof e=="string"||Object.getPrototypeOf(e)===String.prototype?P(String(e)):P(JSON.stringify(e)),P.fromObject=P.from;function ft(e){return new F({protocol:e.protocol,hostname:e.hostname,port:Number(e.port),path:e.pathname,query:Array.from(e.searchParams.entries()).reduce((t,[r,n])=>(t[r]=n,t),{}),fragment:e.hash})}async function lt(e,t){const n=await(0,Fe.c9)(e.body).transformToString();if(e.statusCode===200){const s=JSON.parse(n);if(typeof s.AccessKeyId!="string"||typeof s.SecretAccessKey!="string"||typeof s.Token!="string"||typeof s.Expiration!="string")throw new I("HTTP credential provider response not of the required format, an object matching: { AccessKeyId: string, SecretAccessKey: string, Token: string, Expiration: string(rfc3339) }",{logger:t});return{accessKeyId:s.AccessKeyId,secretAccessKey:s.SecretAccessKey,sessionToken:s.Token,expiration:Ge(s.Expiration)}}if(e.statusCode>=400&&e.statusCode<500){let s={};try{s=JSON.parse(n)}catch{}throw Object.assign(new I(`Server responded with status: ${e.statusCode}`,{logger:t}),{Code:s.Code,Message:s.Message})}throw new I(`Server responded with status: ${e.statusCode}`,{logger:t})}const mt=(e,t,r)=>async()=>{for(let n=0;n<t;++n)try{return await e()}catch{await new Promise(o=>setTimeout(o,r))}return await e()},pt="AWS_CONTAINER_CREDENTIALS_RELATIVE_URI",gt="http://169.254.170.2",yt="AWS_CONTAINER_CREDENTIALS_FULL_URI",wt="AWS_CONTAINER_AUTHORIZATION_TOKEN_FILE",Et="AWS_CONTAINER_AUTHORIZATION_TOKEN",Tt=(e={})=>{e.logger?.debug("@aws-sdk/credential-provider-http - fromHttp");let t;const r=e.awsContainerCredentialsRelativeUri??process.env[pt],n=e.awsContainerCredentialsFullUri??process.env[yt],s=e.awsContainerAuthorizationToken??process.env[Et],o=e.awsContainerAuthorizationTokenFile??process.env[wt],i=e.logger?.constructor?.name==="NoOpLogger"||!e.logger?console.warn:e.logger.warn;if(r&&n&&(i("@aws-sdk/credential-provider-http: you have set both awsContainerCredentialsRelativeUri and awsContainerCredentialsFullUri."),i("awsContainerCredentialsFullUri will take precedence.")),s&&o&&(i("@aws-sdk/credential-provider-http: you have set both awsContainerAuthorizationToken and awsContainerAuthorizationTokenFile."),i("awsContainerAuthorizationToken will take precedence.")),n)t=n;else if(r)t=`${gt}${r}`;else throw new I(`No HTTP credential provider host provided.
Set AWS_CONTAINER_CREDENTIALS_FULL_URI or AWS_CONTAINER_CREDENTIALS_RELATIVE_URI.`,{logger:e.logger});const a=new URL(t);Ue(a,e.logger);const d=new v({requestTimeout:e.timeout??1e3,connectionTimeout:e.timeout??1e3});return mt(async()=>{const g=ft(a);s?g.headers.Authorization=s:o&&(g.headers.Authorization=(await Me().readFile(o)).toString());try{const w=await d.handle(g);return lt(w.response).then(c=>ye(c,"CREDENTIALS_HTTP","z"))}catch(w){throw new I(String(w),{logger:e.logger})}},e.maxRetries??3,e.timeout??1e3)}}};
