"use strict";var Zn=Object.defineProperty;var Xn=(T,C,c)=>C in T?Zn(T,C,{enumerable:!0,configurable:!0,writable:!0,value:c}):T[C]=c;var S=(T,C,c)=>(Xn(T,typeof C!="symbol"?C+"":C,c),c);exports.id=161,exports.ids=[161],exports.modules={84161:(T,C,c)=>{c.d(C,{getDefaultRoleAssumer:()=>Dt,getDefaultRoleAssumerWithWebIdentity:()=>Wt});var $e=c(24383),$t=c(16103),Kt=c(47425),Ke=c(20505),O=c(54855),N=c(94344),kt=c(99329),Z=c(5717),V=c(92146),r=c(12799),_t=c(47072),ke=c(44487);const zt=async(e,n,t)=>({operation:(0,ke.u)(n).operation,region:await(0,ke.t)(e.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function jt(e){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"sts",region:e.region},propertiesExtractor:(n,t)=>({signingProperties:{config:n,context:t}})}}function Ft(e){return{schemeId:"smithy.api#noAuth"}}const Ht=e=>{const n=[];switch(e.operation){case"AssumeRoleWithWebIdentity":{n.push(Ft(e));break}default:n.push(jt(e))}return n},Lt=e=>({...e,stsClientCtor:G}),Mt=e=>{const n=Lt(e);return{...(0,_t.h)(n)}},Ut=e=>({...e,useDualstackEndpoint:e.useDualstackEndpoint??!1,useFipsEndpoint:e.useFipsEndpoint??!1,useGlobalEndpoint:e.useGlobalEndpoint??!1,defaultSigningName:"sts"}),_e={UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}};var Ot=c(89474),Nt=c(19082),ze=c(36124),je=c(79119),Vt=c(73469),D=c(83995),Fe=c(80167),Bt=c(52521),Gt=c(8275),Zt=c(89465),He=c(84132),Le=c(76053),Xt=c(70292),X=c(18393);const Me="required",i="type",l="fn",u="argv",b="ref",Ue=!1,J=!0,w="booleanEquals",y="stringEquals",Oe="sigv4",Ne="sts",Ve="us-east-1",m="endpoint",Be="https://sts.{Region}.{PartitionResult#dnsSuffix}",v="tree",W="error",Y="getAttr",Ge={[Me]:!1,[i]:"String"},Q={[Me]:!0,default:!1,[i]:"Boolean"},Ze={[b]:"Endpoint"},Xe={[l]:"isSet",[u]:[{[b]:"Region"}]},p={[b]:"Region"},Je={[l]:"aws.partition",[u]:[p],assign:"PartitionResult"},Ye={[b]:"UseFIPS"},Qe={[b]:"UseDualStack"},g={url:"https://sts.amazonaws.com",properties:{authSchemes:[{name:Oe,signingName:Ne,signingRegion:Ve}]},headers:{}},A={},qe={conditions:[{[l]:y,[u]:[p,"aws-global"]}],[m]:g,[i]:m},et={[l]:w,[u]:[Ye,!0]},tt={[l]:w,[u]:[Qe,!0]},nt={[l]:Y,[u]:[{[b]:"PartitionResult"},"supportsFIPS"]},st={[b]:"PartitionResult"},ot={[l]:w,[u]:[!0,{[l]:Y,[u]:[st,"supportsDualStack"]}]},rt=[{[l]:"isSet",[u]:[Ze]}],it=[et],ct=[tt],Jt={version:"1.0",parameters:{Region:Ge,UseDualStack:Q,UseFIPS:Q,Endpoint:Ge,UseGlobalEndpoint:Q},rules:[{conditions:[{[l]:w,[u]:[{[b]:"UseGlobalEndpoint"},J]},{[l]:"not",[u]:rt},Xe,Je,{[l]:w,[u]:[Ye,Ue]},{[l]:w,[u]:[Qe,Ue]}],rules:[{conditions:[{[l]:y,[u]:[p,"ap-northeast-1"]}],endpoint:g,[i]:m},{conditions:[{[l]:y,[u]:[p,"ap-south-1"]}],endpoint:g,[i]:m},{conditions:[{[l]:y,[u]:[p,"ap-southeast-1"]}],endpoint:g,[i]:m},{conditions:[{[l]:y,[u]:[p,"ap-southeast-2"]}],endpoint:g,[i]:m},qe,{conditions:[{[l]:y,[u]:[p,"ca-central-1"]}],endpoint:g,[i]:m},{conditions:[{[l]:y,[u]:[p,"eu-central-1"]}],endpoint:g,[i]:m},{conditions:[{[l]:y,[u]:[p,"eu-north-1"]}],endpoint:g,[i]:m},{conditions:[{[l]:y,[u]:[p,"eu-west-1"]}],endpoint:g,[i]:m},{conditions:[{[l]:y,[u]:[p,"eu-west-2"]}],endpoint:g,[i]:m},{conditions:[{[l]:y,[u]:[p,"eu-west-3"]}],endpoint:g,[i]:m},{conditions:[{[l]:y,[u]:[p,"sa-east-1"]}],endpoint:g,[i]:m},{conditions:[{[l]:y,[u]:[p,Ve]}],endpoint:g,[i]:m},{conditions:[{[l]:y,[u]:[p,"us-east-2"]}],endpoint:g,[i]:m},{conditions:[{[l]:y,[u]:[p,"us-west-1"]}],endpoint:g,[i]:m},{conditions:[{[l]:y,[u]:[p,"us-west-2"]}],endpoint:g,[i]:m},{endpoint:{url:Be,properties:{authSchemes:[{name:Oe,signingName:Ne,signingRegion:"{Region}"}]},headers:A},[i]:m}],[i]:v},{conditions:rt,rules:[{conditions:it,error:"Invalid Configuration: FIPS and custom endpoint are not supported",[i]:W},{conditions:ct,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",[i]:W},{endpoint:{url:Ze,properties:A,headers:A},[i]:m}],[i]:v},{conditions:[Xe],rules:[{conditions:[Je],rules:[{conditions:[et,tt],rules:[{conditions:[{[l]:w,[u]:[J,nt]},ot],rules:[{endpoint:{url:"https://sts-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:A,headers:A},[i]:m}],[i]:v},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",[i]:W}],[i]:v},{conditions:it,rules:[{conditions:[{[l]:w,[u]:[nt,J]}],rules:[{conditions:[{[l]:y,[u]:[{[l]:Y,[u]:[st,"name"]},"aws-us-gov"]}],endpoint:{url:"https://sts.{Region}.amazonaws.com",properties:A,headers:A},[i]:m},{endpoint:{url:"https://sts-fips.{Region}.{PartitionResult#dnsSuffix}",properties:A,headers:A},[i]:m}],[i]:v},{error:"FIPS is enabled but this partition does not support FIPS",[i]:W}],[i]:v},{conditions:ct,rules:[{conditions:[ot],rules:[{endpoint:{url:"https://sts.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:A,headers:A},[i]:m}],[i]:v},{error:"DualStack is enabled but this partition does not support DualStack",[i]:W}],[i]:v},qe,{endpoint:{url:Be,properties:A,headers:A},[i]:m}],[i]:v}],[i]:v},{error:"Invalid Configuration: Missing Region",[i]:W}]},Yt=new X.kS({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS","UseGlobalEndpoint"]}),Qt=(e,n={})=>Yt.get(e,()=>(0,X.sO)(Jt,{endpointParams:e,logger:n.logger}));X.mw.aws=Xt.UF;const qt=e=>({apiVersion:"2011-06-15",base64Decoder:e?.base64Decoder??He.E,base64Encoder:e?.base64Encoder??He.n,disableHostPrefix:e?.disableHostPrefix??!1,endpointProvider:e?.endpointProvider??Qt,extensions:e?.extensions??[],httpAuthSchemeProvider:e?.httpAuthSchemeProvider??Ht,httpAuthSchemes:e?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:n=>n.getIdentityProvider("aws.auth#sigv4"),signer:new ze.f2},{schemeId:"smithy.api#noAuth",identityProvider:n=>n.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new N.mR}],logger:e?.logger??new r.N4,serviceId:e?.serviceId??"STS",urlParser:e?.urlParser??Zt.D,utf8Decoder:e?.utf8Decoder??Le.ar,utf8Encoder:e?.utf8Encoder??Le.Pq});var en=c(46793);const tn=e=>{(0,r.I9)(process.version);const n=(0,en.I)(e),t=()=>n().then(r.lT),s=qt(e);(0,Nt.I)(process.version);const o={profile:e?.profile};return{...s,...e,runtime:"node",defaultsMode:n,bodyLengthChecker:e?.bodyLengthChecker??Bt.n,defaultUserAgentProvider:e?.defaultUserAgentProvider??(0,je.pf)({serviceId:s.serviceId,clientVersion:Ot.rE}),httpAuthSchemes:e?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:d=>d.getIdentityProvider("aws.auth#sigv4")||(async a=>await e.credentialDefaultProvider(a?.__config||{})()),signer:new ze.f2},{schemeId:"smithy.api#noAuth",identityProvider:d=>d.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new N.mR}],maxAttempts:e?.maxAttempts??(0,D.Z)(V.qs,e),region:e?.region??(0,D.Z)(O.GG,{...O.zH,...o}),requestHandler:Fe.$c.create(e?.requestHandler??t),retryMode:e?.retryMode??(0,D.Z)({...V.kN,default:async()=>(await t()).retryMode||Gt.L0},e),sha256:e?.sha256??Vt.V.bind(null,"sha256"),streamCollector:e?.streamCollector??Fe.kv,useDualstackEndpoint:e?.useDualstackEndpoint??(0,D.Z)(O.e$,o),useFipsEndpoint:e?.useFipsEndpoint??(0,D.Z)(O.Ko,o),userAgentAppId:e?.userAgentAppId??(0,D.Z)(je.hV,o)}};var at=c(63928),q=c(91551);const nn=e=>{const n=e.httpAuthSchemes;let t=e.httpAuthSchemeProvider,s=e.credentials;return{setHttpAuthScheme(o){const d=n.findIndex(a=>a.schemeId===o.schemeId);d===-1?n.push(o):n.splice(d,1,o)},httpAuthSchemes(){return n},setHttpAuthSchemeProvider(o){t=o},httpAuthSchemeProvider(){return t},setCredentials(o){s=o},credentials(){return s}}},sn=e=>({httpAuthSchemes:e.httpAuthSchemes(),httpAuthSchemeProvider:e.httpAuthSchemeProvider(),credentials:e.credentials()}),B=e=>e,on=(e,n)=>{const t={...B((0,at.Rq)(e)),...B((0,r.xA)(e)),...B((0,q.eS)(e)),...B(nn(e))};return n.forEach(s=>s.configure(t)),{...e,...(0,at.$3)(t),...(0,r.uv)(t),...(0,q.jt)(t),...sn(t)}};class G extends r.Kj{constructor(...[t]){const s=tn(t||{}),o=Ut(s),d=(0,Ke.Dc)(o),a=(0,V.$z)(d),h=(0,O.TD)(a),E=(0,$e.OV)(h),P=(0,Z.Co)(E),L=Mt(P),M=on(L,t?.extensions||[]);super(M);S(this,"config");this.config=M,this.middlewareStack.use((0,Ke.sM)(this.config)),this.middlewareStack.use((0,V.ey)(this.config)),this.middlewareStack.use((0,kt.vK)(this.config)),this.middlewareStack.use((0,$e.TC)(this.config)),this.middlewareStack.use((0,$t.Y7)(this.config)),this.middlewareStack.use((0,Kt.n4)(this.config)),this.middlewareStack.use((0,N.wB)(this.config,{httpAuthSchemeParametersProvider:zt,identityProviderConfigProvider:async U=>new N.h$({"aws.auth#sigv4":U.credentials})})),this.middlewareStack.use((0,N.lW)(this.config))}destroy(){super.destroy()}}var dt=c(96720);class R extends r.TJ{constructor(n){super(n),Object.setPrototypeOf(this,R.prototype)}}const lt=e=>({...e,...e.SecretAccessKey&&{SecretAccessKey:r.$H}}),rn=e=>({...e,...e.Credentials&&{Credentials:lt(e.Credentials)}});class ee extends R{constructor(t){super({name:"ExpiredTokenException",$fault:"client",...t});S(this,"name","ExpiredTokenException");S(this,"$fault","client");Object.setPrototypeOf(this,ee.prototype)}}class te extends R{constructor(t){super({name:"MalformedPolicyDocumentException",$fault:"client",...t});S(this,"name","MalformedPolicyDocumentException");S(this,"$fault","client");Object.setPrototypeOf(this,te.prototype)}}class ne extends R{constructor(t){super({name:"PackedPolicyTooLargeException",$fault:"client",...t});S(this,"name","PackedPolicyTooLargeException");S(this,"$fault","client");Object.setPrototypeOf(this,ne.prototype)}}class se extends R{constructor(t){super({name:"RegionDisabledException",$fault:"client",...t});S(this,"name","RegionDisabledException");S(this,"$fault","client");Object.setPrototypeOf(this,se.prototype)}}class oe extends R{constructor(t){super({name:"IDPRejectedClaimException",$fault:"client",...t});S(this,"name","IDPRejectedClaimException");S(this,"$fault","client");Object.setPrototypeOf(this,oe.prototype)}}class re extends R{constructor(t){super({name:"InvalidIdentityTokenException",$fault:"client",...t});S(this,"name","InvalidIdentityTokenException");S(this,"$fault","client");Object.setPrototypeOf(this,re.prototype)}}const cn=e=>({...e,...e.WebIdentityToken&&{WebIdentityToken:r.$H}}),an=e=>({...e,...e.Credentials&&{Credentials:lt(e.Credentials)}});class ie extends R{constructor(t){super({name:"IDPCommunicationErrorException",$fault:"client",...t});S(this,"name","IDPCommunicationErrorException");S(this,"$fault","client");Object.setPrototypeOf(this,ie.prototype)}}var dn=c(12763),ln=c(38770);const ce=(e,n)=>(0,ln.w)(e,n).then(t=>{if(t.length){const s=new dn.XMLParser({attributeNamePrefix:"",htmlEntities:!0,ignoreAttributes:!1,ignoreDeclaration:!0,parseTagValue:!1,trimValues:!1,tagValueProcessor:(E,P)=>P.trim()===""&&P.includes(`
`)?"":void 0});s.addEntity("#xD","\r"),s.addEntity("#10",`
`);let o;try{o=s.parse(t,!0)}catch(E){throw E&&typeof E=="object"&&Object.defineProperty(E,"$responseBodyText",{value:t}),E}const d="#text",a=Object.keys(o)[0],h=o[a];return h[d]&&(h[a]=h[d],delete h[d]),(0,r.rm)(h)}return{}}),un=async(e,n)=>{const t=await ce(e,n);return t.Error&&(t.Error.message=t.Error.message??t.Error.Message),t},Yn=(e,n)=>{if(n?.Error?.Code!==void 0)return n.Error.Code;if(n?.Code!==void 0)return n.Code;if(e.statusCode==404)return"NotFound"},mn=async(e,n)=>{const t=pt;let s;return s=At({...Rn(e,n),[Et]:Mn,[St]:gt}),yt(n,t,"/",void 0,s)},fn=async(e,n)=>{const t=pt;let s;return s=At({...Cn(e,n),[Et]:Un,[St]:gt}),yt(n,t,"/",void 0,s)},hn=async(e,n)=>{if(e.statusCode>=300)return ut(e,n);const t=await ce(e.body,n);let s={};return s=Wn(t.AssumeRoleResult,n),{$metadata:I(e),...s}},yn=async(e,n)=>{if(e.statusCode>=300)return ut(e,n);const t=await ce(e.body,n);let s={};return s=$n(t.AssumeRoleWithWebIdentityResult,n),{$metadata:I(e),...s}},ut=async(e,n)=>{const t={...e,body:await un(e.body,n)},s=On(e,t.body);switch(s){case"ExpiredTokenException":case"com.amazonaws.sts#ExpiredTokenException":throw await pn(t,n);case"MalformedPolicyDocument":case"com.amazonaws.sts#MalformedPolicyDocumentException":throw await An(t,n);case"PackedPolicyTooLarge":case"com.amazonaws.sts#PackedPolicyTooLargeException":throw await Pn(t,n);case"RegionDisabledException":case"com.amazonaws.sts#RegionDisabledException":throw await vn(t,n);case"IDPCommunicationError":case"com.amazonaws.sts#IDPCommunicationErrorException":throw await gn(t,n);case"IDPRejectedClaim":case"com.amazonaws.sts#IDPRejectedClaimException":throw await En(t,n);case"InvalidIdentityToken":case"com.amazonaws.sts#InvalidIdentityTokenException":throw await Sn(t,n);default:const o=t.body;return Ln({output:e,parsedBody:o.Error,errorCode:s})}},pn=async(e,n)=>{const t=e.body,s=Kn(t.Error,n),o=new ee({$metadata:I(e),...s});return(0,r.Mw)(o,t)},gn=async(e,n)=>{const t=e.body,s=kn(t.Error,n),o=new ie({$metadata:I(e),...s});return(0,r.Mw)(o,t)},En=async(e,n)=>{const t=e.body,s=_n(t.Error,n),o=new oe({$metadata:I(e),...s});return(0,r.Mw)(o,t)},Sn=async(e,n)=>{const t=e.body,s=zn(t.Error,n),o=new re({$metadata:I(e),...s});return(0,r.Mw)(o,t)},An=async(e,n)=>{const t=e.body,s=jn(t.Error,n),o=new te({$metadata:I(e),...s});return(0,r.Mw)(o,t)},Pn=async(e,n)=>{const t=e.body,s=Fn(t.Error,n),o=new ne({$metadata:I(e),...s});return(0,r.Mw)(o,t)},vn=async(e,n)=>{const t=e.body,s=Hn(t.Error,n),o=new se({$metadata:I(e),...s});return(0,r.Mw)(o,t)},Rn=(e,n)=>{const t={};if(e[F]!=null&&(t[F]=e[F]),e[H]!=null&&(t[H]=e[H]),e[z]!=null){const s=mt(e[z],n);e[z]?.length===0&&(t.PolicyArns=[]),Object.entries(s).forEach(([o,d])=>{const a=`PolicyArns.${o}`;t[a]=d})}if(e[_]!=null&&(t[_]=e[_]),e[k]!=null&&(t[k]=e[k]),e[Ce]!=null){const s=Dn(e[Ce],n);e[Ce]?.length===0&&(t.Tags=[]),Object.entries(s).forEach(([o,d])=>{const a=`Tags.${o}`;t[a]=d})}if(e[xe]!=null){const s=Tn(e[xe],n);e[xe]?.length===0&&(t.TransitiveTagKeys=[]),Object.entries(s).forEach(([o,d])=>{const a=`TransitiveTagKeys.${o}`;t[a]=d})}if(e[he]!=null&&(t[he]=e[he]),e[ve]!=null&&(t[ve]=e[ve]),e[Ie]!=null&&(t[Ie]=e[Ie]),e[x]!=null&&(t[x]=e[x]),e[ge]!=null){const s=bn(e[ge],n);e[ge]?.length===0&&(t.ProvidedContexts=[]),Object.entries(s).forEach(([o,d])=>{const a=`ProvidedContexts.${o}`;t[a]=d})}return t},Cn=(e,n)=>{const t={};if(e[F]!=null&&(t[F]=e[F]),e[H]!=null&&(t[H]=e[H]),e[we]!=null&&(t[we]=e[we]),e[Ee]!=null&&(t[Ee]=e[Ee]),e[z]!=null){const s=mt(e[z],n);e[z]?.length===0&&(t.PolicyArns=[]),Object.entries(s).forEach(([o,d])=>{const a=`PolicyArns.${o}`;t[a]=d})}return e[_]!=null&&(t[_]=e[_]),e[k]!=null&&(t[k]=e[k]),t},mt=(e,n)=>{const t={};let s=1;for(const o of e){if(o===null)continue;const d=In(o,n);Object.entries(d).forEach(([a,h])=>{t[`member.${s}.${a}`]=h}),s++}return t},In=(e,n)=>{const t={};return e[Te]!=null&&(t[Te]=e[Te]),t},xn=(e,n)=>{const t={};return e[pe]!=null&&(t[pe]=e[pe]),e[me]!=null&&(t[me]=e[me]),t},bn=(e,n)=>{const t={};let s=1;for(const o of e){if(o===null)continue;const d=xn(o,n);Object.entries(d).forEach(([a,h])=>{t[`member.${s}.${a}`]=h}),s++}return t},wn=(e,n)=>{const t={};return e[ye]!=null&&(t[ye]=e[ye]),e[be]!=null&&(t[be]=e[be]),t},Tn=(e,n)=>{const t={};let s=1;for(const o of e)o!==null&&(t[`member.${s}`]=o,s++);return t},Dn=(e,n)=>{const t={};let s=1;for(const o of e){if(o===null)continue;const d=wn(o,n);Object.entries(d).forEach(([a,h])=>{t[`member.${s}.${a}`]=h}),s++}return t},ft=(e,n)=>{const t={};return e[de]!=null&&(t[de]=(0,r.lK)(e[de])),e[le]!=null&&(t[le]=(0,r.lK)(e[le])),t},Wn=(e,n)=>{const t={};return e[K]!=null&&(t[K]=ht(e[K],n)),e[$]!=null&&(t[$]=ft(e[$],n)),e[j]!=null&&(t[j]=(0,r.xW)(e[j])),e[x]!=null&&(t[x]=(0,r.lK)(e[x])),t},$n=(e,n)=>{const t={};return e[K]!=null&&(t[K]=ht(e[K],n)),e[Pe]!=null&&(t[Pe]=(0,r.lK)(e[Pe])),e[$]!=null&&(t[$]=ft(e[$],n)),e[j]!=null&&(t[j]=(0,r.xW)(e[j])),e[Se]!=null&&(t[Se]=(0,r.lK)(e[Se])),e[ue]!=null&&(t[ue]=(0,r.lK)(e[ue])),e[x]!=null&&(t[x]=(0,r.lK)(e[x])),t},ht=(e,n)=>{const t={};return e[ae]!=null&&(t[ae]=(0,r.lK)(e[ae])),e[Ae]!=null&&(t[Ae]=(0,r.lK)(e[Ae])),e[Re]!=null&&(t[Re]=(0,r.lK)(e[Re])),e[fe]!=null&&(t[fe]=(0,r.Y0)((0,r.t_)(e[fe]))),t},Kn=(e,n)=>{const t={};return e[f]!=null&&(t[f]=(0,r.lK)(e[f])),t},kn=(e,n)=>{const t={};return e[f]!=null&&(t[f]=(0,r.lK)(e[f])),t},_n=(e,n)=>{const t={};return e[f]!=null&&(t[f]=(0,r.lK)(e[f])),t},zn=(e,n)=>{const t={};return e[f]!=null&&(t[f]=(0,r.lK)(e[f])),t},jn=(e,n)=>{const t={};return e[f]!=null&&(t[f]=(0,r.lK)(e[f])),t},Fn=(e,n)=>{const t={};return e[f]!=null&&(t[f]=(0,r.lK)(e[f])),t},Hn=(e,n)=>{const t={};return e[f]!=null&&(t[f]=(0,r.lK)(e[f])),t},I=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}),Qn=(e,n)=>collectBody(e,n).then(t=>n.utf8Encoder(t)),Ln=(0,r.jr)(R),yt=async(e,n,t,s,o)=>{const{hostname:d,protocol:a="https",port:h,path:E}=await e.endpoint(),P={protocol:a,hostname:d,port:h,method:"POST",path:E.endsWith("/")?E.slice(0,-1)+t:E+t,headers:n};return s!==void 0&&(P.hostname=s),o!==void 0&&(P.body=o),new q.Kd(P)},pt={"content-type":"application/x-www-form-urlencoded"},gt="2011-06-15",Et="Action",ae="AccessKeyId",Mn="AssumeRole",de="AssumedRoleId",$="AssumedRoleUser",Un="AssumeRoleWithWebIdentity",le="Arn",ue="Audience",K="Credentials",me="ContextAssertion",k="DurationSeconds",fe="Expiration",he="ExternalId",ye="Key",_="Policy",z="PolicyArns",pe="ProviderArn",ge="ProvidedContexts",Ee="ProviderId",j="PackedPolicySize",Se="Provider",F="RoleArn",H="RoleSessionName",Ae="SecretAccessKey",Pe="SubjectFromWebIdentityToken",x="SourceIdentity",ve="SerialNumber",Re="SessionToken",Ce="Tags",Ie="TokenCode",xe="TransitiveTagKeys",St="Version",be="Value",we="WebIdentityToken",Te="arn",f="message",At=e=>Object.entries(e).map(([n,t])=>(0,r.$6)(n)+"="+(0,r.$6)(t)).join("&"),On=(e,n)=>{if(n.Error?.Code!==void 0)return n.Error.Code;if(e.statusCode==404)return"NotFound"};class Pt extends r.uB.classBuilder().ep(_e).m(function(n,t,s,o){return[(0,dt.TM)(s,this.serialize,this.deserialize),(0,Z.rD)(s,n.getEndpointParameterInstructions())]}).s("AWSSecurityTokenServiceV20110615","AssumeRole",{}).n("STSClient","AssumeRoleCommand").f(void 0,rn).ser(mn).de(hn).build(){}class vt extends r.uB.classBuilder().ep(_e).m(function(n,t,s,o){return[(0,dt.TM)(s,this.serialize,this.deserialize),(0,Z.rD)(s,n.getEndpointParameterInstructions())]}).s("AWSSecurityTokenServiceV20110615","AssumeRoleWithWebIdentity",{}).n("STSClient","AssumeRoleWithWebIdentityCommand").f(cn,an).ser(fn).de(yn).build(){}const Nn={AssumeRoleCommand:Pt,AssumeRoleWithWebIdentityCommand:vt};class Vn extends G{}(0,r.J1)(Nn,Vn);var De=c(96172);const Rt="us-east-1",Ct=e=>{if(typeof e?.Arn=="string"){const n=e.Arn.split(":");if(n.length>4&&n[4]!=="")return n[4]}},It=async(e,n,t)=>{const s=typeof e=="function"?await e():e,o=typeof n=="function"?await n():n;return t?.debug?.("@aws-sdk/client-sts::resolveRegion","accepting first of:",`${s} (provider)`,`${o} (parent client)`,`${Rt} (STS default)`),s??o??Rt},xt=(e,n)=>{let t,s;return async(o,d)=>{if(s=o,!t){const{logger:L=e?.parentClientConfig?.logger,region:M,requestHandler:U=e?.parentClientConfig?.requestHandler,credentialProviderLogger:We}=e,Bn=await It(M,e?.parentClientConfig?.region,We),Gn=!wt(U);t=new n({profile:e?.parentClientConfig?.profile,credentialDefaultProvider:()=>async()=>s,region:Bn,requestHandler:Gn?U:void 0,logger:L})}const{Credentials:a,AssumedRoleUser:h}=await t.send(new Pt(d));if(!a||!a.AccessKeyId||!a.SecretAccessKey)throw new Error(`Invalid response from STS.assumeRole call with role ${d.RoleArn}`);const E=Ct(h),P={accessKeyId:a.AccessKeyId,secretAccessKey:a.SecretAccessKey,sessionToken:a.SessionToken,expiration:a.Expiration,...a.CredentialScope&&{credentialScope:a.CredentialScope},...E&&{accountId:E}};return(0,De.g)(P,"CREDENTIALS_STS_ASSUME_ROLE","i"),P}},bt=(e,n)=>{let t;return async s=>{if(!t){const{logger:E=e?.parentClientConfig?.logger,region:P,requestHandler:L=e?.parentClientConfig?.requestHandler,credentialProviderLogger:M}=e,U=await It(P,e?.parentClientConfig?.region,M),We=!wt(L);t=new n({profile:e?.parentClientConfig?.profile,region:U,requestHandler:We?L:void 0,logger:E})}const{Credentials:o,AssumedRoleUser:d}=await t.send(new vt(s));if(!o||!o.AccessKeyId||!o.SecretAccessKey)throw new Error(`Invalid response from STS.assumeRoleWithWebIdentity call with role ${s.RoleArn}`);const a=Ct(d),h={accessKeyId:o.AccessKeyId,secretAccessKey:o.SecretAccessKey,sessionToken:o.SessionToken,expiration:o.Expiration,...o.CredentialScope&&{credentialScope:o.CredentialScope},...a&&{accountId:a}};return a&&(0,De.g)(h,"RESOLVED_ACCOUNT_ID","T"),(0,De.g)(h,"CREDENTIALS_STS_ASSUME_ROLE_WEB_ID","k"),h}},qn=e=>n=>e({roleAssumer:xt(n,n.stsClientCtor),roleAssumerWithWebIdentity:bt(n,n.stsClientCtor),...n}),wt=e=>e?.metadata?.handlerProtocol==="h2",Tt=(e,n)=>n?class extends e{constructor(s){super(s);for(const o of n)this.middlewareStack.use(o)}}:e,Dt=(e={},n)=>xt(e,Tt(G,n)),Wt=(e={},n)=>bt(e,Tt(G,n)),es=e=>n=>e({roleAssumer:Dt(n),roleAssumerWithWebIdentity:Wt(n),...n})}};
